# 🧠 專案上下文文件 (Project Context for AI)

> **Purpose**: 提供 AI 在 Feature 開發階段所需的專案全貌理解  
> **Version**: {VERSION}  
> **Last Updated**: {DATE}  
> **維護頻率**: 每完成一個 Feature 並執行 Unify Flow 後更新  
> **產生指令**: `.flowkit.system-context`

---

## 1. 專案定位 (Project Identity)

### 1.1 一句話描述 (One-liner)

**{PROJECT_NAME}** 是一個 **{核心定位描述}**，{主要功能與價值}。

<!-- 
範例：
**VideoNote** 是一個 **Video-first 知識萃取與管理工具**，將影片內容轉化為可搜尋、可回溯的時間軸逐字稿，並透過互動式播放器實現「影音與文字同步」的學習體驗。
-->

### 1.2 核心價值主張

| 面向 | 價值 |
|------|------|
| **使用者** | {使用者獲得的主要價值} |
| **開發者** | {對開發者/自動化的價值} |
| **資料層** | {資料管理的價值} |

### 1.3 目標使用者

- **{使用者類型 A}**：{使用場景描述}
- **{使用者類型 B}**：{使用場景描述}
- **{使用者類型 C}**：{使用場景描述}

---

## 2. 系統架構概覽 (Architecture Overview)

### 2.1 高階架構圖

```
┌─────────────────────────────────────────────────────────────────────┐
│                         USER INTERFACES                             │
├─────────────────────────────────────────────────────────────────────┤
│  {介面 A}                    │  {介面 B}                             │
│  - {技術/框架}              │  - {技術/框架}                         │
│  - {特性}                   │  - {特性}                              │
└─────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────┐
│                         CORE LAYER                                  │
├─────────────────────────────────────────────────────────────────────┤
│  {核心模組名稱} ({路徑})                                             │
│  - {職責描述}                                                        │
└─────────────────────────────────────────────────────────────────────┘
                                    │
        ┌───────────────────────────┼───────────────────────────┐
        ▼                           ▼                           ▼
┌───────────────┐         ┌───────────────┐         ┌───────────────┐
│ {子系統 A}    │         │ {子系統 B}    │         │ {子系統 C}      │
│ ({路徑})      │         │ ({路徑})      │         │ ({路徑})       │
├───────────────┤         ├───────────────┤         ├───────────────┤
│ {模組 1}      │         │ {模組 1}      │         │ {模組 1}       │
│ {模組 2}      │         │ {模組 2}      │         │ {模組 2}       │
└───────────────┘         └───────────────┘         └───────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────┐
│                       STORAGE / DATA LAYER                          │
├─────────────────────────────────────────────────────────────────────┤
│  {儲存模組} ({路徑})                                                 │
│  - {資料儲存方式描述}                                                │
└─────────────────────────────────────────────────────────────────────┘
```

### 2.2 模組邊界與職責 (Boundaries)

> ⚠️ **禁止跨越邊界**：除非有明確理由，否則不得讓模組 A 直接存取模組 B 的內部實作。

| 模組 | 職責（一句話） | 擁有的資料/契約 | Public API 路徑 |
|------|----------------|-----------------|-----------------|
| `{模組 A}` | {職責} | {擁有什麼} | `{path/to/api}` |
| `{模組 B}` | {職責} | {擁有什麼} | `{path/to/api}` |
| `{模組 C}` | {職責} | {擁有什麼} | `{path/to/api}` |

### 2.3 入口點 (Entry Points)

> 🎯 **開發時從這裡開始找**

| 類型 | 路徑 | 說明 |
|------|------|------|
| **UI 路由** | `{path}` | {說明} |
| **UI 元件** | `{path}` | {說明} |
| **API 端點** | `{path}` | {說明} |
| **Domain 邏輯** | `{path}` | {說明} |
| **資料層** | `{path}` | {說明} |
| **排程/事件** | `{path}` | {說明} |

### 2.4 資料流向

```
{輸入} → {處理階段 1} → {處理階段 2} → {處理階段 N} → {輸出}
                                            │
                                            ▼
                                     {儲存位置}
```

---

## 3. 已完成 Feature 清單 (Feature Registry)

> 🔑 **重要**：新 Feature 開發時，務必確認是否與既有 Feature 有交集，避免重複實作或破壞既有行為。

### 3.1 Feature 時間軸

| Feature ID | 名稱 | 狀態 | 核心能力 |
|------------|------|------|----------|
| {ID} | {Feature 名稱} | ✅ Completed | {一句話描述核心能力} |
| {ID} | {Feature 名稱} | 🚧 In Progress | {一句話描述核心能力} |
| {ID} | {Feature 名稱} | 📋 Planned | {一句話描述核心能力} |

<!-- 
狀態圖示：
✅ Completed - 已完成
🚧 In Progress - 開發中
📋 Planned - 已規劃
❌ Cancelled - 已取消
-->

### 3.2 已實作的功能群組

| 群組 | 涵蓋範圍 | 相關檔案 |
|------|----------|----------|
| **{群組名稱}** | {涵蓋的功能範圍} | `{相關路徑}` |
| **{群組名稱}** | {涵蓋的功能範圍} | `{相關路徑}` |

### 3.3 共享模組清單 (Shared Services)

> 🔧 **這些模組已經存在，請直接使用，不要重新實作**

| 模組 | 路徑 | 用途 | 如何使用 |
|------|------|------|----------|
| {模組名稱} | `{path}` | {用途} | `{使用範例}` |
| {模組名稱} | `{path}` | {用途} | `{使用範例}` |

---

## 4. 關鍵資料模型 (Core Data Models)

> 📍 完整定義請見 `specs/system/data-model.md`

### 4.1 核心實體關係

```
{Entity A} ({儲存位置})
       │
       │ {關係類型，如 1:N}
       ▼
{Entity B} ({儲存位置})
       │
       │ {關係類型}
       ▼
{Entity C} ({儲存位置})
```

### 4.2 關鍵欄位摘要

**{Entity A}**（{中文名稱}）：
- `{field_name}`: {型別} - {說明}
- `{field_name}`: {型別} - {說明}
- `{field_name}`: {型別} - {說明}

**{Entity B}**（{中文名稱}）：
- `{field_name}`: {型別} - {說明}
- `{field_name}`: {型別} - {說明}

### 4.3 契約與 Schema 索引 (Key Contracts)

| 類型 | 路徑 | 說明 |
|------|------|------|
| HTTP API | `{path}` | {說明} |
| Events | `{path}` | {說明} |
| DB Schema | `{path}` | {說明} |

### 4.4 目錄結構規範

```
{root}/
├── {目錄名稱}/                    # {用途說明}
│   └── {子目錄或檔案}/
├── {目錄名稱}/                    # {用途說明}
│   └── {結構說明}/
└── {重要檔案}                     # {用途說明}
```

---

## 5. 核心流程 (Golden Flows)

> 📍 完整流程圖請見 `specs/system/flows.md`

### 5.1 主要流程：{流程名稱}

```
{輸入} → {階段 1} → {階段 2} → {階段 3} → {輸出}
   │          │          │          │          │
   ▼          ▼          ▼          ▼          ▼
{說明}    {說明}    {說明}    {說明}    {說明}
```

**路徑追蹤**：
```
UI({screen}) → API({endpoint}) → Domain({usecase}) → Data({table/file})
```

### 5.2 次要流程：{流程名稱}

```
{簡要流程描述}
```

**路徑追蹤**：
```
{path} → {path} → {path}
```

---

## 6. 技術棧與約定 (Tech Stack & Conventions)

### 6.1 技術棧

| 層級 | 技術 | 版本 |
|------|------|------|
| **語言** | {語言} | {版本} |
| **套件管理** | {工具} | {版本} |
| **框架** | {框架} | {版本} |
| **資料庫** | {資料庫} | {版本} |
| **測試框架** | {框架} | {版本} |

### 6.2 整合約定 (Integration Rules) 🔴 NON-NEGOTIABLE

| 類別 | 規範 |
|------|------|
| **依賴注入** | {規範} |
| **錯誤處理** | {規範} |
| **日誌** | {規範} |
| **測試** | {規範} |
| **API 規範** | {規範} |

### 6.3 程式碼風格

- {風格/原則 1}
- {風格/原則 2}
- {風格/原則 3}
- 註解規範：`# TODO:`, `# FIXME:`, `# HACK:`

---

## 7. Where-to-Look Playbook

> 🎯 **遇到問題時，去哪裡找答案**

### 7.1 依情境查找

| 遇到... | 第一步 | 第二步 | 第三步 |
|---------|--------|--------|--------|
| **UI 樣式/主題問題** | `{path}` | `{path}` | — |
| **UI 行為 Bug** | `{path}` | `{path}` | `{path}` |
| **資料不一致** | `{path}` | `{path}` | `{path}` |
| **權限/驗證問題** | `{path}` | `{path}` | `{path}` |
| **核心流程問題** | `{path}` | `{path}` | `{path}` |
| **檔案/儲存問題** | `{path}` | `{path}` | — |

### 7.2 如果你要...

| 需求 | 涉及模組 | 注意事項 |
|------|----------|----------|
| **{需求描述}** | `{模組路徑}` | {注意事項} |
| **{需求描述}** | `{模組路徑}` | {注意事項} |
| **{需求描述}** | `{模組路徑}` | {注意事項} |

---

## 8. 深入探索指引 (Documentation Index)

| 想了解... | 去哪裡看 |
|-----------|----------|
| 系統完整 User Stories | `specs/system/spec.md` |
| 資料模型完整定義 | `specs/system/data-model.md` |
| 系統流程圖 | `specs/system/flows.md` |
| API/CLI 合約 | `specs/system/contracts/` |
| 特定 Feature 規格 | `specs/features/{feature_id}/spec.md` |
| 測試案例 | `tests/` |
| 技術債清單 | `docs/technical-debt.md` |

---

## 9. AI 開發提示 (AI Development Hints)

### 9.1 新 Feature 開發 Checklist

1. ✅ 閱讀本文件，了解專案全貌
2. ✅ 確認與既有 Feature 的交集（參考第 3 節）
3. ✅ 確認是否有可複用的共享模組（參考第 3.3 節）
4. ✅ 確認涉及的資料模型（參考第 4 節）
5. ✅ 確認涉及的流程（參考第 5 節）
6. ✅ 確認整合約定（參考第 6.2 節）
7. ✅ 使用 Where-to-Look 定位程式碼（參考第 7 節）
8. ✅ 深入閱讀相關 spec 文件（參考第 8 節）

### 9.2 常見陷阱 (Known Pitfalls)

| 陷阱 | 說明 | 預防方式 |
|------|------|----------|
| **{陷阱名稱}** | {問題描述} | {預防/解決方式} |
| **{陷阱名稱}** | {問題描述} | {預防/解決方式} |
| **{陷阱名稱}** | {問題描述} | {預防/解決方式} |

### 9.3 快速參考

```bash
# {常用指令 1 說明}
{指令}

# {常用指令 2 說明}
{指令}

# {常用指令 3 說明}
{指令}
```

---

## 10. 版本歷史 (Version History)

| 版本 | 日期 | 變更說明 |
|------|------|----------|
| {版本號} | {日期} | {變更說明} |

---

> 📌 **維護提醒**：每完成一個 Feature 並執行 Unify Flow 後，執行 `.flowkit.system-context` 更新本文件。
