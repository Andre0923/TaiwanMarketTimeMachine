# 衝突報告 — [Milestone 名稱]

> **產生時間**：[timestamp]  
> **目標 Milestone**：[MNN-MilestoneName]  
> **來源文件**：[PRD.md, 附加文件清單]  
> **嚴重性**：[CRITICAL / HIGH / MEDIUM / LOW]  
> **衝突數量**：N 項

---

## 1. 衝突摘要

| ID | 類別 | 項目 | PRD 位置 | System 位置 | 嚴重性 | 狀態 |
|----|------|------|----------|-------------|--------|------|
| C1 | DM | [Entity/欄位名] | PRD#Section | data-model.md | HIGH | 確定衝突 |
| C2 | FL | [Flow 名稱] | PRD#Section | flows.md | MEDIUM | 待確認 |
| C3 | CT | [Contract 名稱] | PRD#Section | contracts/x.md | HIGH | 確定衝突 |
| ... | ... | ... | ... | ... | ... | ... |

**狀態說明**：
- **確定衝突**：PRD 與 System 定義明確不一致，必須解決
- **待確認**：存在差異但可能為意圖內擴展，需人工判斷

---

## 2. 衝突詳情

### C1: [項目名稱]

**類別**：[DM / FL / CT / CF / UI]  
**嚴重性**：[HIGH / MEDIUM / LOW]  
**狀態**：確定衝突

#### PRD 定義

> 來源：[PRD.md#Section, 行 xxx-xxx]

```sql
-- 或其他格式的定義
[PRD 中的完整定義]
```

**關鍵特徵**：
- [特徵 1]
- [特徵 2]

#### System 定義

> 來源：[specs/system/data-model.md#EntityName]

```sql
-- 或其他格式的定義
[System 中的完整定義]
```

**關鍵特徵**：
- [特徵 1]
- [特徵 2]

#### 差異分析

| 比較項目 | PRD | System | 差異類型 |
|----------|-----|--------|----------|
| [欄位/屬性 1] | [值] | [值] | 型別不同 |
| [欄位/屬性 2] | [值] | [值] | 約束不同 |
| [欄位/屬性 3] | 有定義 | 無定義 | 新增 |
| ... | ... | ... | ... |

**衝突影響**：
- [影響 1]：[說明]
- [影響 2]：[說明]

#### 建議解決方案

| 方案 | 說明 | 影響範圍 | 建議 |
|------|------|----------|------|
| **A. 以 PRD 為準** | 更新 System Spec | 需走 Unify Flow | ⭐ 推薦 |
| **B. 以 System 為準** | 調整 PRD 或 Plan | 需與 Stakeholder 確認 | - |
| **C. 合併** | 整合兩者定義 | 需設計新方案 | - |

**推薦理由**：
[解釋為何推薦該方案]

---

### C2: [項目名稱]

**類別**：[DM / FL / CT / CF / UI]  
**嚴重性**：[HIGH / MEDIUM / LOW]  
**狀態**：待確認

#### PRD 定義

> 來源：[PRD.md#Section, 行 xxx-xxx]

```
[PRD 中的定義]
```

#### System 定義

> 來源：[specs/system/xxx.md]

```
[System 中的定義]
```

#### 差異分析

[差異說明]

#### 需確認的問題

- [ ] 這是意圖內的變更嗎？
- [ ] 是否需要擴展 System 定義？
- [ ] [其他需確認的問題]

---

## 3. 衝突統計

### 3.1 依類別

| 類別 | 確定衝突 | 待確認 | 總計 |
|------|----------|--------|------|
| DM（資料模型） | N | N | N |
| FL（流程設計） | N | N | N |
| CT（契約定義） | N | N | N |
| CF（設定規格） | N | N | N |
| UI（UI 規格） | N | N | N |
| **總計** | N | N | N |

### 3.2 依嚴重性

| 嚴重性 | 數量 | 說明 |
|--------|------|------|
| CRITICAL | N | 阻擋性，必須立即解決 |
| HIGH | N | 重大不一致，Plan 前必須解決 |
| MEDIUM | N | 中等差異，應在 Plan 中說明 |
| LOW | N | 輕微差異，可延後處理 |

---

## 4. 解決優先序

建議依以下順序解決衝突：

| 優先序 | 衝突 ID | 原因 |
|--------|---------|------|
| 1 | C1 | [原因：如「被其他衝突依賴」] |
| 2 | C3 | [原因] |
| 3 | C2 | [原因] |

---

## 5. 處理建議

### 5.1 確定衝突處理流程

```
┌─────────────────────────────────────┐
│ 1. 逐項檢視衝突詳情                  │
└─────────────────────────────────────┘
              │
              ▼
┌─────────────────────────────────────┐
│ 2. 選擇解決方案（A/B/C）             │
└─────────────────────────────────────┘
              │
    ┌─────────┼─────────┐
    ▼         ▼         ▼
  方案 A    方案 B    方案 C
 以 PRD    以 System   合併
  為準      為準
    │         │         │
    ▼         ▼         ▼
 Unify     調整 PRD   設計
 Flow      或 Plan    新方案
    │         │         │
    └─────────┼─────────┘
              ▼
┌─────────────────────────────────────┐
│ 3. 重新執行衝突檢測驗證              │
│    /flowkit.plan-context            │
│    --check-conflict                 │
└─────────────────────────────────────┘
```

### 5.2 待確認衝突處理

- 與 Stakeholder（產品經理/開發負責人）討論
- 確認是「意圖內擴展」還是「真正衝突」
- 若為意圖內擴展 → 標記為已解決
- 若為真正衝突 → 轉為「確定衝突」處理

---

## 6. 下一步

### 6.1 必要行動

- [ ] 解決所有「確定衝突」（共 N 項）
- [ ] 確認所有「待確認」項目（共 N 項）
- [ ] 重新執行 `/flowkit.plan-context --check-conflict` 驗證

### 6.2 選用行動

- [ ] 更新 PRD 以反映最終決策
- [ ] 記錄決策理由至 Feature Spec 或 Plan

### 6.3 完成標準

衝突視為已解決的條件：
- 所有「確定衝突」皆已處理（擇一方案並執行）
- 所有「待確認」皆已確認（標記為已解決或轉為衝突處理）
- 重新執行衝突檢測後，衝突數量為 0

---

## 附錄：相關文件連結

| 文件 | 位置 | 說明 |
|------|------|------|
| PRD | [docs/requirements/PRD.md] | 產品需求文件 |
| System Data Model | [specs/system/data-model.md] | 系統資料模型 |
| System Flows | [specs/system/flows.md] | 系統流程設計 |
| System Contracts | [specs/system/contracts/] | 系統契約定義 |
| Unify Flow 指南 | [功能說明-flowkit.unify-flow.md] | 更新 System Spec 流程 |
